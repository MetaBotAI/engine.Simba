#!/usr/bin/bash

sudo apt update

# pre
sudo mkdir -p /app
cd /app

# steps:
# - name: Install Dependencies (Linux)
sudo apt -y install libgtk2.0-dev \
libpango1.0-dev \
libffi-dev \
libxtst-dev \
curl
#xvfb

# workflow vars
name='Linux 64'
FPCUP='https://github.com/LongDirtyAnimAlf/Reiniero-fpcup/releases/download/v2.2.0c/fpclazup-x86_64-linux'
FPC_VER='https://svn.freepascal.org/svn/fpc/tags/release_3_2_0'
LAZ_VER='--build-mode=SIMBA_DARWIN64'
LAZ_OPT='--build-mode=SIMBA_LINUX64'

# Fix: fpcup error
sudo apt -y install subversion

sudo chown -R $USER:$USER /app

# - name: Install Lazarus
curl --retry 5 -L -o fpcup $FPCUP
mkdir lazarus || true
chmod +x fpcup
# Only used on Mac: $FPCUP_OPT
./fpcup --installdir=lazarus --fpcURL=$FPC_VER --lazURL=$LAZ_VER $FPCUP_OPT --noconfirm --verbose

